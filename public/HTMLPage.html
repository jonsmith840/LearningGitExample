<!DOCTYPE html>

<html lang="en">
    <head>
      <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
      <link type="text/css" href="/css/teachapp.css" rel="stylesheet">
      <link rel="icon" type="image/png" href="favicon.png" />
    	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
      <!--<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
      <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>
        <meta charset="utf-8" />
        <title>Oxford Open Learning for Mentors & Supervisors</title>
        <script type="text/javascript">
        function showList(){
          $('#StuffGoesHere').toggle();
          $('#ShowHide').toggle();
        }
        function showStudent(Code){
          var studentjson = { QueryString : "ContactDetailsAuthIDSP" , Params : {Contact : [Code]}};
          $.ajax({
    				url: './',
    				type: 'post',
    				data: JSON.stringify(studentjson),
    				dataType: 'json',
    				contentType: 'application/json; charset=utf-8',
    				success: function( data ) {
              var studentHtml = "<h2>Student details for " + data[0].FirstName + " " + data[0].LastName + "</h2>";
              alert(studentHtml);
              $('#StuffGoesHere').html(studentHtml);
              console.log(data);
            }
          });
        }
        	$(document).ready( function(){

        		$("#header").load("header.html");
        		var postjson = { QueryString : "InvoiceCustomerContactsAuthSP" , Params : {}};
			$.ajax({
				url: './',
				type: 'post',
				data: JSON.stringify(postjson),
				dataType: 'json',
				contentType: 'application/json; charset=utf-8',
				success: function( data ) {
				//alert(JSON.stringify(data));
        var items = data.length;
        var welcomeHtml = 'Welcome ' + data[0].AuthName + "<h3>A total of " + items + " students. <button id='ShowHide' class='btn-default' onclick='showList()'>Show/hide</button></h3>";
        $('#WelcomeMessage').html(welcomeHtml);
        console.log(welcomeHtml);
				var tableHtml = "<table id='StudentList'><tr><th>Name</th><th>Contact</th><th>Select</th></tr>";
				$.each(data, function(key, datarow) {
					tableHtml += '<tr><td>' + datarow.FirstName + ' ' + datarow.LastName + '</td><td>' + datarow.Code + '</td><td><input type="radio" name="SelectStudent" id="SelectStudent" value="' + datarow.Code + '" onclick="showStudent(' + datarow.Code + ')"></td></tr>';
				});
				tableHtml += "</table>";
				// please check logs in browser console
				console.log(tableHtml);
				$('#StuffGoesHere').html(tableHtml);
				//var idjson = { QueryString : "InvoiceCustomerAuthIDSP" , Params : {}};
				//$.ajax({
				//url: './',
					//type: 'post',
					//data: JSON.stringify(idjson),
					//dataType: 'json',
					//contentType: 'application/json; charset=utf-8',
					//success: function( iddata ) {
					//alert(JSON.stringify(data));
					//$.each(iddata, function(key, iddatarow) {
						//welcomeHtml += iddatarow.FirstName + ' ' + iddatarow.LastName;
					//});
					  //welcomeHtml += ".";
					//console.log(welcomeHtml);
					//$('#WelcomeMessage').append(welcomeHtml);
					//}
				//});
				}
			});
        	});
        </script>
    </head>
    <body>
      <div id="header"></div>
    <h2><div id="WelcomeMessage"></div></h2>
    <div id="StuffGoesHere" style="display:none"></div>
    </body>
</html>
